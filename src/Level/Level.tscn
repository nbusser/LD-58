[gd_scene load_steps=11 format=3 uid="uid://fkx747pj67wj"]

[ext_resource type="Script" uid="uid://drh117nvpnukt" path="res://src/Level/Level.gd" id="1"]
[ext_resource type="PackedScene" uid="uid://btohiqrak4tcf" path="res://src/Map/Map.tscn" id="2"]
[ext_resource type="PackedScene" uid="uid://dwiu4cm7rlq0p" path="res://src/HUD/HUD.tscn" id="3_p81om"]
[ext_resource type="Shader" path="res://src/Level/PostProcess.gdshader" id="4_5g3p6"]
[ext_resource type="Script" uid="uid://uvipfx8brsj0" path="res://src/UI/PostProcessOverlay.gd" id="4_c7nqk"]
[ext_resource type="Shader" uid="uid://ccoc5wp0cgskd" path="res://src/Laser.gdshader" id="4_noe52"]
[ext_resource type="Script" uid="uid://bqub0n7gx4ukd" path="res://src/AudioBankPlayer.gd" id="7_1b0u6"]
[ext_resource type="AudioStream" uid="uid://curqsvlnprpo1" path="res://assets/sounds/timeout.wav" id="8_qpfp4"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_sbvk8"]
shader = ExtResource("4_noe52")
shader_parameter/laser_count = 1
shader_parameter/resolution = Vector2(256, 256)
shader_parameter/laser_points = PackedVector2Array(0, 0, 1, 0.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
shader_parameter/laser_states = PackedFloat32Array(1, 0, 0, 0, 0, 0, 0, 0)
shader_parameter/laser_hue = 0.0
shader_parameter/intensity = 0.2
shader_parameter/beam_width = 0.71
shader_parameter/core_width = 0.17
shader_parameter/edge_softness = 0.15
shader_parameter/pulse_speed = 0.85
shader_parameter/pulse_amplitude = 0.12
shader_parameter/noise_scale = 17.0
shader_parameter/noise_speed = 4.67
shader_parameter/noise_intensity = 1.0
shader_parameter/energy_flow_speed = 8.0
shader_parameter/glow_radius = 1.55
shader_parameter/distortion_amount = 0.11
shader_parameter/distortion_freqs = Color(0.47058824, 0.14901961, 0.36078432, 0.64705884)
shader_parameter/flicker_speed = 8.0
shader_parameter/flicker_intensity = 0.2

[sub_resource type="ShaderMaterial" id="ShaderMaterial_post_process"]
shader = ExtResource("4_5g3p6")
shader_parameter/desaturate_amount = 0.0
shader_parameter/overlay_color = Vector3(0.95, 0.95, 1)
shader_parameter/overlay_amount = 0.0
shader_parameter/bloom_intensity = 1.0

[node name="Level" type="Node"]
script = ExtResource("1")

[node name="Map" parent="." instance=ExtResource("2")]

[node name="BaseEffects" type="CanvasLayer" parent="."]

[node name="LaserSurface" type="ColorRect" parent="BaseEffects" groups=["laser_surface"]]
unique_name_in_owner = true
material = SubResource("ShaderMaterial_sbvk8")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0.35409713, 0.7342835, 0.4462875, 1)

[node name="PostProcessing" type="CanvasLayer" parent="."]

[node name="PostProcessOverlay" type="ColorRect" parent="PostProcessing"]
z_index = 100
material = SubResource("ShaderMaterial_post_process")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
script = ExtResource("4_c7nqk")

[node name="UI" type="CanvasLayer" parent="."]

[node name="HUD" parent="UI" instance=ExtResource("3_p81om")]

[node name="Fadeout" type="ColorRect" parent="UI"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
color = Color(0, 0, 0, 0)

[node name="Timer" type="Timer" parent="."]
wait_time = 60.0
one_shot = true
autostart = true

[node name="SFX" type="Node" parent="."]

[node name="TimeoutSound" type="AudioStreamPlayer" parent="SFX"]
script = ExtResource("7_1b0u6")
sounds = Array[AudioStream]([ExtResource("8_qpfp4")])
metadata/_custom_type_script = "uid://bqub0n7gx4ukd"

[connection signal="timeout" from="Timer" to="." method="_on_Timer_timeout"]
